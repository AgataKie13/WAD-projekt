---
title: "Wielowymiarowa analiza jakości wina na podstawie danych fizykochemicznych"
author: "Agata Kierznikowicz, Zuzanna Łomża"
date: "2025-12-05"
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Biblioteki:
library(readr)
library(skimr)
library(dplyr)
```

# 1. Wprowadzenie

## 1.1. Motywacja i cel pracy

::: {style="text-align: justify;"}
Produkcja wina to proces, nad którym na co dzień rzadko się
zastanawiamy, choć sam napój towarzyszy wielu ważnym wydarzeniom.
Jednocześnie dostępne są obszerne dane opisujące właściwości chemiczne
win – zarówno czerwonych, jak i białych. Skoro dysponujemy tak bogatym
materiałem, warto z niego skorzystać, aby sprawdzić, które parametry
wpływają na jakość wina. W projekcie skupimy się jednak na jednym
wybranym zbiorze danych, aby analiza była bardziej przejrzysta. Wino
powstaje w wyniku szeregu złożonych procesów, które wymagają kontroli
wielu cech fizykochemicznych, takich jak kwasowość, zawartość alkoholu,
poziom cukrów resztkowych, gęstość czy pH. To właśnie te parametry w
dużej mierze decydują o ostatecznej ocenie trunku przez ekspertów.
Ponieważ zmiennych jest wiele i są ze sobą powiązane, trudno analizować
je pojedynczo, dlatego w projekcie zastosowano metody wielowymiarowej
analizy danych. Celem projektu jest lepsze zrozumienie zależności między
właściwościami wina oraz określenie, które z nich najbardziej wpływają
na jego jakość. W tym celu wykorzystano m.in. analizę PCA, metody
klasteryzacji oraz inne techniki eksploracyjne, które pomagają
uporządkować dane i wydobyć najważniejsze informacje.

**Główne cele projektu to:**

-   zbadanie zależności między właściwościami fizykochemicznymi wina,
-   identyfikacja zmiennych, które najsilniej wpływają na ocenę jakości,
-   zastosowanie PCA do redukcji wymiarowości i interpretacji
    składowych,
-   wykrycie naturalnych grup win przy użyciu metod analizy skupień
    (klastrów),
-   ocena przydatności zastosowanych metod w analizie jakości wina.
:::

## 1.2. Opis problemu badawczego

::: {style="text-align: justify;"}
Powyżej przedstawiony został ogólny zarys poruszanego problemu
badawczego. Nietrudno zauważyć, że zmiennych opisujących wino jest
wiele, a ich wzajemne relacje są złożone i trudne do oceny bez
odpowiednich metod statystycznych.

W związku z tym w projekcie należy odpowiedzieć na kilka głównych pytań:

-   Które parametry fizykochemiczne są ze sobą najsilniej powiązane?
-   Które zmienne w największym stopniu wpływają na ocenę jakości wina?
-   Czy dane wina można uporządkować w naturalne grupy, np. na podstawie
    podobieństwa chemicznego?
-   Czy redukcja wymiarowości (np. PCA) pozwala lepiej zrozumieć
    strukturę danych i uprościć ich interpretację?
:::

## 1.3. Opis danych

::: {style="text-align: justify;"}
Dane wykorzystane w projekcie pochodzą z bezpłatnego repozytorium UC
Irvine Machine Learning Repository i są dostępne pod adresem Wine
Quality. Zbiór dotyczy win z regionu Vinho Verde i stanowi kompletny
oraz liczny materiał, dobrze przystosowany do analiz wielowymiarowych.

*dostęp:* <https://archive.ics.uci.edu/dataset/186/wine+quality> P.
Cortez, A. Cerdeira, F. Almeida, T. Matos and J. Reis. Modeling wine
preferences by data mining from physicochemical properties. In Decision
Support Systems, Elsevier, 47(4):547-553. ISSN: 0167-9236.

W projekcie wykorzystano część danych dotyczącą wina białego, obejmującą
4898 obserwacji oraz 12 zmiennych – 11 fizykochemicznych i jedną
wynikową quality, ocenianą w skali 0–10. Wszystkie zmienne objaśniające
mają charakter ilościowy, dzięki czemu możliwe jest stosowanie metod
opartych na macierzy korelacji, PCA oraz analizie klastrów. *Zmienne
objaśniające* (wejściowe) odzwierciedlają parametry chemiczne uzyskane w
testach laboratoryjnych, natomiast *zmienna objaśniana* (wyjściowa)
opiera się na sensorycznej ocenie jakości. Na podstawie artykułu
określono również, które zmienne objaśniające są *stymulantami*, a które
*destymulantami*. Struktura danych przedstawiona została poniżej.

*Zmienna objaśniana:*

-   **jakość** (ocena 0-10)

*Zmienne objaśniające:*

-   **stała kwasowość** destymulanta
-   **lotna kwasowość** destymulanta
-   **kwas cytrynowy** stymulanta
-   **cukier resztkowy** destymulanta
-   **chlorki** destymulanta
-   **wolny dwutlenek siarki** destymulanta
-   **całkowity dwutlenek siarki** destymulanta
-   **gęstość** destymulanta
-   **pH** stymulanta
-   **siarczany** stymulanta
-   **alkohol** stymulanta
:::

```{r wine, echo=FALSE, results='asis'}
wina <- read.csv("winequality-white.csv", header=TRUE, sep=';')
wina <- wina %>%
  rename(
    stała_kwasowość             = fixed.acidity,
    lotna_kwasowość             = volatile.acidity,
    kwas_cytrynowy              = citric.acid,
    cukier_resztkowy            = residual.sugar,
    chlorki                     = chlorides,
    wolny_dwutlenek_siarki      = free.sulfur.dioxide,
    całkowity_dwutlenek_siarki  = total.sulfur.dioxide,
    gęstość                     = density,
    siarczany                   = sulphates,
    jakość                      = quality
  )

target <- "quality"

metadata <- wina %>%
  summarise(
    liczba_wierszy = n(),
    liczba_kolumn = ncol(.)
  ) %>%
  bind_cols(
    tibble(
      zmienna = names(wina),
      typ_danych = sapply(wina, function(x) class(x)[1]),
      stymulanta_destymulanta = c("destymulanta", "destymulanta", "stymulanta", "destymulanta", "destymulanta",
  "destymulanta", "destymulanta", "destymulanta", "stymulanta", "stymulanta", "stymulanta", "zmienna objaśniania")
    )
  )

metadata
```

# 2. Analiza eksploracyjna danych

## 2.1. Podstawowe statystyki opisowe
(średnia, mediana, odchylenie standardowe, kwartyle

```{r}
#install.packages("gtsummary")
library(gtsummary)

wina %>%
  tbl_summary(
    by = jakość,
    statistic = list(
      all_continuous() ~ "{mean} ({p25}; {p50}; {p75}; {min}; {max})",  
      all_categorical() ~ "{n} ({p}%)"                           
    )
  ) %>%
  modify_caption("**Tabela 1. Statystyki opisowe według jakości wina**") %>%
  modify_footnote(
    all_stat_cols() ~ "Zmienne ciągłe: średnia (kwantyl 1; mediana; kwantyl 3; minimum; maksimum); zmienne kategoryczne: liczność (%); Brakujące dane zostały wykluczone z analizy."
  ) %>%
  add_p() %>%
  bold_labels()  # pogrubienie nazw zmiennych



packageVersion("gt")
packageVersion("htmltools")
packageVersion("gtsummary")

install.packages(c("gt", "htmltools"))



```

## 2.2. Analiza rozkładów

## 2.3. Analiza korelacji

## 2.4. Analiza braków danych

```{r}
print(colSums(is.na(dane)))
```

## 2.5. Analiza obserwacji odstających

## 2.6. Zidentyfikuj potencjalne obserwacje odstające






